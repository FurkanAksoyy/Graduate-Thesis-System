<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add {{ model_name|capfirst }}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
</head>

<body>
    <div class="container mt-4">
        <h1>Add New {{ model_name|capfirst }}</h1>
        <form method="POST">
            {% csrf_token %}

            {% if model_name == 'author' %}
            <div class="mb-3">
                <label for="author_name" class="form-label">Author Name:</label>
                <input type="text" class="form-control" name="author_name" required>
            </div>

            {% elif model_name == 'cosupervisor' %}
            <div class="mb-3">
                <label for="cosup_name" class="form-label">Cosupervisor Name:</label>
                <input type="text" class="form-control" name="cosup_name" required>
            </div>
            {% elif model_name == 'institute' %}
            <div class="mb-3">
                <label for="institute_name" class="form-label">Institute Name:</label>
                <input type="text" class="form-control" name="institute_name" id="institute_name" placeholder="Enter institute name" required>
            </div>
            <div class="mb-3">
                <label for="university" class="form-label">University:</label>
                <select class="form-control" name="university" id="university" required>
                    <option value="" disabled selected>-- Select University --</option>
                    {% for university in universities %}
                        <option value="{{ university.university_id }}">{{ university.university_name }}</option>
                    {% endfor %}
                </select>
            </div>
        

            {% elif model_name == 'keyword' %}
            <div class="mb-3">
                <label for="keyword_name" class="form-label">Keyword Name:</label>
                <input type="text" class="form-control" name="keyword_name" required>
            </div>

            {% elif model_name == 'language' %}
            <div class="mb-3">
                <label for="language_name" class="form-label">Language Name:</label>
                <input type="text" class="form-control" name="language_name" required>
            </div>

            {% elif model_name == 'subjecttopic' %}
            <div class="mb-3">
                <label for="topic_name" class="form-label">Subject Topic Name:</label>
                <input type="text" class="form-control" name="topic_name" required>
            </div>

            {% elif model_name == 'supervisor' %}
            <div class="mb-3">
                <label for="supervisor_name" class="form-label">Supervisor Name:</label>
                <input type="text" class="form-control" name="supervisor_name" required>
            </div>

            {% elif model_name == 'thesis' %}

            <div class="mb-3">
                <label for="title">Title:</label>
                <input type="text" id="title" name="title" required>
            </div>

            <div class="mb-3">
                <label for="abstract">Abstract:</label>
                <textarea id="abstract" name="abstract"></textarea>
            </div>

            <div class="mb-3">
                <label for="new_author_name">New Author:</label>
                <input type="text" id="new_author_name" name="new_author_name" placeholder="Enter new author name">
            </div>

            <div class="mb-3">
                <label for="author_id">Or Select Existing Author:</label>
                <select id="author_id" name="author_id">
                    <option value="">-- Select Author --</option>
                    {% for author in authors %}
                    <option value="{{ author.author_id }}">{{ author.author_name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label for="year">Year:</label>
                <select id="year" name="year" required>
                    <option value="">-- Select Year --</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="type_id">Type:</label>
                <select id="type_id" name="type_id" required>
                    <option value="">-- Select Type --</option>
                    {% for type in types %}
                    <option value="{{ type.type_id }}">{{ type.type_name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label for="university_id">University:</label>
                <select id="university_id" name="university_id" required>
                    <option value="">-- Select University --</option>
                    {% for university in universities %}
                    <option value="{{ university.university_id }}">{{ university.university_name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label for="institute_id">Institute:</label>
                <select id="institute_id" name="institute_id" required disabled>
                    <option value="">-- Select Institute --</option>
                </select>
                <div id="institute-error" class="error" style="display:none;">Please select an institute</div>
            </div>


            <div class="mb-3">
                <label for="number_of_pages">Number of Pages:</label>
                <input type="number" id="number_of_pages" name="number_of_pages" required min="1">
            </div>

            <div class="mb-3">
                <label for="language_id">Language:</label>
                <select id="language_id" name="language_id" required>
                    <option value="">-- Select Language --</option>
                    {% for language in languages %}
                    <option value="{{ language.language_id }}">{{ language.language_name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label for="submission_date">Submission Date:</label>
                <input type="date" id="submission_date" name="submission_date" required>
            </div>

            <div class="mb-3">
                <label for="new_supervisor_name">New Supervisor:</label>
                <input type="text" id="new_supervisor_name" name="new_supervisor_name"
                    placeholder="Enter new supervisor name">
            </div>

            <div class="mb-3">
                <label for="supervisor_id">Or Select Existing Supervisor:</label>
                <select id="supervisor_id" name="supervisor_id">
                    <option value="">-- Select Supervisor --</option>
                    {% for supervisor in supervisors %}
                    <option value="{{ supervisor.supervisor_id }}">{{ supervisor.supervisor_name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label for="new_cosupervisor_name">New Co-supervisor (Optional):</label>
                <input type="text" id="new_cosupervisor_name" name="new_cosupervisor_name"
                    placeholder="Enter new co-supervisor name">
            </div>

            <div class="mb-3">
                <label for="cosup_id">Or Select Existing Cosupervisor:</label>
                <select id="cosup_id" name="cosup_id">
                    <option value="">-- Select Cosupervisor --</option>
                    {% for cosupervisor in cosupervisors %}
                    <option value="{{ cosupervisor.cosup_id }}">{{ cosupervisor.cosup_name }}</option>
                    {% endfor %}
                </select>
            </div>



        

            {% elif model_name == 'thesiskeyword' %}
            <div class="mb-3">
                <label for="thesis_no" class="form-label">Thesis:</label>
                <select class="form-control" name="thesis_no" required>
                    {% for thesis in theses %}
                    <option value="{{ thesis.thesis_no }}">{{ thesis.title }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-3">
                <label for="keyword" class="form-label">Keyword:</label>
                <select class="form-control" name="keyword" required>
                    {% for keyword in keywords %}
                    <option value="{{ keyword.keyword_id }}">{{ keyword.keyword_name }}</option>
                    {% endfor %}
                </select>
            </div>

            {% elif model_name == 'thesissubject' %}
            <div class="mb-3">
                <label for="thesis_no" class="form-label">Thesis:</label>
                <select class="form-control" name="thesis_no" required>
                    {% for thesis in theses %}
                    <option value="{{ thesis.thesis_no }}">{{ thesis.title }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-3">
                <label for="thesissubject" class="form-label">Subject Topic:</label>
                <select class="form-control" name="thesissubject" required>
                    {% for subjecttopic in subjecttopics %}
                    <option value="{{ subjecttopic.topic_id }}">{{ subjecttopic.topic_name }}</option>
                    {% endfor %}
                </select>
            </div>

            {% elif model_name == 'type' %}
            <div class="mb-3">
                <label for="type_name" class="form-label">Type Name:</label>
                <input type="text" class="form-control" name="type_name" required>
            </div>

            {% elif model_name == 'university' %}
            <div class="mb-3">
                <label for="university_name" class="form-label">University Name:</label>
                <input type="text" class="form-control" name="university_name" required>
            </div>
            {% endif %}

            <button type="submit" class="btn btn-primary">Add</button>
            <a href="{% url 'home' %}" class="btn btn-secondary">Back to Home</a>
        </form>
    </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Generate year options
    const startYear = 1980;
    const endYear = 2025;
    const yearSelect = document.getElementById('year');

    for (let year = endYear; year >= startYear; year--) {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        yearSelect.appendChild(option);
    }

    const institutes = [
        {% for institute in institutes %}
        {
            institute_id: "{{ institute.institute_id|escapejs }}",
            institute_name: "{{ institute.institute_name|escapejs }}",
            university_id: "{{ institute.university_id|escapejs }}"
        } {% if not forloop.last %}, {% endif %}
        {% endfor %}
    ];

    document.getElementById('university_id').addEventListener('change', function () {
        const selectedUniversityId = this.value;
        const instituteSelect = document.getElementById('institute_id');
        instituteSelect.innerHTML = '<option value="">-- Select Institute --</option>';
        instituteSelect.disabled = true;

        if (selectedUniversityId) {
            const filteredInstitutes = institutes.filter(
                institute => institute.university_id == selectedUniversityId
            );

            filteredInstitutes.forEach(institute => {
                const option = document.createElement('option');
                option.value = institute.institute_id;
                option.textContent = institute.institute_name;
                instituteSelect.appendChild(option);
            });

            if (filteredInstitutes.length > 0) {
                instituteSelect.disabled = false;
            }
        }
    });
</script>



    <style>
        /* Modern CSS Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Variables */
        :root {
            --primary-color: #0d6efd;
            --secondary-color: #0a58ca;
            --background-color: #f8f9fa;
            --text-color: #212529;
            --border-color: #dee2e6;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.1);
            --radius: 0.5rem;
        }

        /* General Styles */
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            background-color: var(--background-color);
            color: var(--text-color);
            padding: 1rem;
        }

        /* Container */
        .container {
            max-width: 960px;
            margin: 2rem auto;
            padding: 1rem;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        /* Header */
        h1 {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: bold;
        }

        /* Form Styles */
        form {
            margin-top: 1.5rem;
        }

        .mb-3 {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-color);
        }

        input[type="text"],
        input[type="number"],
        input[type="date"],
        textarea,
        select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 1rem;
            color: var(--text-color);
            background-color: white;
            transition: border-color 0.3s;
        }

        input:focus,
        textarea:focus,
        select:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Button Styles */
        button {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            text-align: center;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
        }

        .btn-secondary {
            background-color: var(--border-color);
            color: var(--text-color);
        }

        .btn-secondary:hover {
            background-color: var(--text-color);
            color: white;
        }

        /* Utility Classes */
        .mt-4 {
            margin-top: 1.5rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1.5rem;
            }

            h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</body>

</html>